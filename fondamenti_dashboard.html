<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Fondamenti di Automatica + Matlab - Marcello Bonfè - Dashboard Studio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>

    :root {
      --bg: #f3f4f6;
      --card-bg: #ffffff;
      --accent: #2563eb;
      --accent-soft: #3b82f6;
      --accent-light: #e0f2ff;
      --text: #111827;
      --text-soft: #6b7280;
      --border-soft: #d1d5db;
      --danger: #dc2626;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
    }

    header {
      padding: 16px 24px;
      border-bottom: 1px solid var(--border-soft);
      background: #ffffff;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    header h1 {
      margin: 0;
      font-size: 1.4rem;
      font-weight: 600;
      letter-spacing: 0.03em;
      color: var(--text);
    }

    header .subtitle {
      font-size: 0.85rem;
      color: var(--text-soft);
    }

    .tag {
      display: inline-flex;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--accent-soft);
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--accent);
      background: var(--accent-light);
    }

    main {
      padding: 16px 24px 32px;
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .card {
      background: var(--card-bg);
      border-radius: 14px;
      border: 1px solid var(--border-soft);
      box-shadow: 0 4px 12px rgba(15, 23, 42, 0.06);
      overflow: hidden;
    }

    .card-header {
      padding: 10px 16px;
      border-bottom: 1px solid var(--border-soft);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      background: #f9fafb;
    }

    .card-header h2 {
      margin: 0;
      font-size: 1rem;
      font-weight: 600;
      color: var(--text);
    }

    .card-header span {
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    .card-body {
      padding: 12px 16px 16px;
    }

    /* Navigazione video */
    .video-controls-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 8px 0 8px;
      gap: 8px;
      flex-wrap: wrap;
    }

    .video-nav {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.85rem;
      color: var(--text-soft);
      white-space: nowrap;
    }

    .nav-btn {
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: #ffffff;
      padding: 2px 8px;
      cursor: pointer;
      font-size: 0.8rem;
      line-height: 1.4;
    }

    .nav-btn:hover {
      background: #eff6ff;
      border-color: #bfdbfe;
    }

    /* Video section */
    .video-player-wrapper {
      margin-bottom: 8px;
      background: #000000;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid var(--border-soft);
    }

    .video-iframe-container {
      position: relative;
      width: 100%;
      padding-top: 56.25%; /* 16:9 */
      background: #000000;
    }

    .video-iframe-container iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
      border-radius: 0;
    }

    .video-hint {
      font-size: 0.8rem;
      color: #e5e7eb;
      padding: 6px 10px;
      border-top: 1px solid #111827;
      background: #0f172a;
    }

    .video-hint strong {
      color: #ffffff;
    }

    .playlist {
      max-height: 320px;
      overflow-y: auto;
      padding-right: 4px;
      scrollbar-width: thin;
      scrollbar-color: var(--accent) #f3f4f6;
    }

    .playlist::-webkit-scrollbar {
      width: 6px;
    }
    .playlist::-webkit-scrollbar-thumb {
      background: var(--accent);
      border-radius: 999px;
    }
    .playlist::-webkit-scrollbar-track {
      background: #f3f4f6;
    }

    .playlist-item {
      width: 100%;
      border: none;
      background: transparent;
      display: flex;
      text-align: left;
      padding: 8px;
      margin-bottom: 4px;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.12s ease, border 0.12s ease, transform 0.05s ease;
      border: 1px solid transparent;
      position: relative;
    }

    .playlist-item:hover {
      background: #eff6ff;
      border-color: #bfdbfe;
      transform: translateY(-1px);
    }

    .playlist-item.active {
      border-color: var(--accent-soft);
      background: #dbeafe;
    }

    .playlist-item.seen:not(.active) {
      background: #f3f4ff;
      border-color: #e0e7ff;
    }

    .playlist-thumbnail {
      width: 72px;
      height: 40px;
      border-radius: 6px;
      background: var(--accent-soft);
      margin-right: 10px;
      position: relative;
      flex-shrink: 0;
    }

    .playlist-thumbnail .play-icon {
      position: absolute;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 0.8rem;
      color: #ffffff;
    }

    .playlist-meta {
      flex: 1;
      min-width: 0;
    }

    .playlist-title {
      font-size: 0.9rem;
      font-weight: 500;
      margin-bottom: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: var(--text);
    }

    .playlist-subtitle {
      font-size: 0.75rem;
      color: var(--text-soft);
      display: flex;
      gap: 6px;
      align-items: center;
      flex-wrap: wrap;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 1px 6px;
      border-radius: 999px;
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border: 1px solid;
    }

    .badge-lesson {
      border-color: #cbd5f5;
      color: #4b5563;
      background: #f9fafb;
    }

    .badge-tutorato {
      border-color: #2563eb;
      color: #1d4ed8;
      background: #eff6ff;
    }

    .badge-extra {
      border-color: #fb923c;
      color: #c05621;
      background: #ffedd5;
    }

    .playlist-item.tutorato .playlist-thumbnail {
      background: #60a5fa;
    }

    .seen-flag {
      font-size: 0.7rem;
      color: #16a34a;
    }

    /* Pomodoro */
    .pomodoro-section .card-body {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .pomodoro-timer {
      font-size: 2.2rem;
      font-weight: 600;
      text-align: center;
      letter-spacing: 0.08em;
      padding: 8px 0;
      border-radius: 10px;
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      color: #1e293b;
    }

    .pomodoro-controls {
      display: flex;
      gap: 8px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .btn {
      border-radius: 999px;
      padding: 6px 14px;
      border: 1px solid var(--border-soft);
      background: #ffffff;
      color: var(--text);
      font-size: 0.8rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background 0.12s ease, transform 0.05s ease, box-shadow 0.12s, border 0.12s;
    }

    .btn:hover {
      background: #eff6ff;
      border-color: #bfdbfe;
      box-shadow: 0 2px 6px rgba(15,23,42,0.08);
      transform: translateY(-1px);
    }

    .btn-primary {
      border-color: var(--accent-soft);
      background: var(--accent);
      color: #ffffff;
    }

    .btn-primary:hover {
      background: #1d4ed8;
    }

    .btn-danger {
      border-color: #fecaca;
      background: #fee2e2;
      color: #b91c1c;
    }

    .btn-danger:hover {
      background: #fecaca;
      border-color: #fca5a5;
    }

    .btn-small {
      font-size: 0.75rem;
      padding: 4px 10px;
    }

    .pomodoro-progress {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    .pomodoro-dots {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .pomodoro-dot {
      width: 14px;
      height: 14px;
      border-radius: 999px;
      border: 1px solid var(--border-soft);
      background: #ffffff;
    }

    .pomodoro-dot.done {
      background: #3b82f6;
      border-color: #2563eb;
    }

    .pomodoro-info {
      font-size: 0.75rem;
      color: var(--text-soft);
      line-height: 1.4;
    }

    .pomodoro-info strong {
      color: var(--text);
    }

    /* Notes & walkthrough */
    .notes-section .card-body,
    .walkthrough-section .card-body {
      display: flex;
      flex-direction: column;
      gap: 10px;
      font-size: 0.85rem;
    }

    .notes-group {
      border-radius: 10px;
      padding: 8px 10px;
      background: #f9fafb;
      border: 1px solid var(--border-soft);
    }

    .notes-group-title {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 6px;
    }

    .notes-group-title h3 {
      margin: 0;
      font-size: 0.9rem;
      font-weight: 500;
      color: var(--text);
    }

    .notes-group-title span {
      font-size: 0.75rem;
      color: var(--text-soft);
    }

    /* Anteprima materiale */
    .material-preview-wrapper {
      margin-bottom: 10px;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid var(--border-soft);
      background: #e5f0ff;
    }

    .material-iframe-container {
      position: relative;
      width: 100%;
      padding-top: 56.25%; /* 16:9, come il videoplayer */
      background: #0b1120;
    }

    .material-iframe-container iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    .material-hint {
      font-size: 0.8rem;
      color: var(--text-soft);
      padding: 6px 10px;
      background: #eff6ff;
      border-top: 1px solid var(--border-soft);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .material-hint strong {
      color: var(--text);
    }

    .material-info {
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    /* Griglia materiale */
    .resources-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 8px;
      margin-top: 4px;
    }

    .resource-card {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      padding: 8px;
      border-radius: 10px;
      background: #ffffff;
      border: 1px solid var(--border-soft);
      transition: border 0.12s ease, box-shadow 0.12s ease, transform 0.05s ease, background 0.12s ease;
      cursor: pointer;
    }

    .resource-card:hover {
      border-color: #bfdbfe;
      box-shadow: 0 2px 6px rgba(15,23,42,0.08);
      background: #f9fafb;
      transform: translateY(-1px);
    }

    .resource-icon {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      font-weight: 600;
      color: #ffffff;
      flex-shrink: 0;
    }

    .ext-pdf {
      background: #2563eb;
    }
    .ext-docx {
      background: #0ea5e9;
    }
    .ext-ppt {
      background: #f97316;
    }
    .ext-img {
      background: #22c55e;
    }
    .ext-svg {
      background: #a855f7;
    }
    .ext-zip {
      background: #6b7280;
    }

    .resource-content {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .resource-header {
      display: flex;
      align-items: center;
      gap: 6px;
      justify-content: space-between;
      min-width: 0;
    }

    .resource-title {
      font-size: 0.85rem;
      font-weight: 500;
      color: #1d4ed8;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .resource-open {
      font-size: 0.8rem;
      color: #6b7280;
      text-decoration: none;
      flex-shrink: 0;
    }

    .resource-open:hover {
      color: #1e40af;
      text-decoration: underline;
    }

    .resource-meta {
      font-size: 0.75rem;
      color: var(--text-soft);
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      align-items: center;
    }

    .resource-pill {
      padding: 1px 6px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      font-size: 0.7rem;
      background: #f9fafb;
    }

    .resource-date {
      font-size: 0.74rem;
    }

    /* Walkthrough */
    .walkthrough-section ol {
      margin: 4px 0 0;
      padding-left: 18px;
    }

    .walkthrough-section li {
      margin-bottom: 6px;
    }

    .walkthrough-section ul {
      margin: 2px 0 6px;
      padding-left: 16px;
    }

    .walkthrough-section li strong {
      color: var(--text);
    }
  

    .badge-lab {
      border-color: #16a34a;
      color: #166534;
      background: #dcfce7;
    }

    .playlist-item.lab .playlist-thumbnail {
      background: #22c55e;
    }

  </style>
</head>
<body>
  <header>
    <div>
      <h1>Fondamenti di Automatica (6 CFU) + Matlab (3 CFU) · Marcello Bonfè</h1>
      <div class="subtitle">Dashboard studio · player stile YouTube · materiale in anteprima · pomodoro</div>
    </div>
    <div class="tag">Modalità deep work</div>
  </header>

  <main>
    <!-- VIDEO: FONDAMENTI -->
    <section class="card video-section">
      <div class="card-header">
        <div>
          <h2>Lezioni (Fondamenti · 6 CFU)</h2>
          <span>Player stile YouTube · ordine cronologico · segna come visto</span>
        </div>
      </div>
      <div class="card-body">
        <div class="video-player-wrapper">
          <div class="video-iframe-container">
            <iframe
              id="videoPlayerFond"
              src=""
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>
          <div class="video-hint">
            <strong>Nota:</strong> i video sono su Google Drive. Devi essere loggato con l'account abilitato per poterli
            riprodurre. Usa il tasto del player per il <strong>full screen</strong>.
          </div>
        </div>

        <div class="video-controls-row">
          <div class="video-nav">
            <button id="prevVideoBtnFond" class="nav-btn" aria-label="Video precedente">◀</button>
            <span id="videoPositionFond">1 / 1</span>
            <button id="nextVideoBtnFond" class="nav-btn" aria-label="Video successivo">▶</button>
          </div>
          <button id="markSeenBtnFond" class="btn btn-small">✓ Segna come visto</button>
        </div>

        <div class="playlist" id="playlistFond"></div>
      </div>
    </section>

    <!-- VIDEO: MATLAB -->
    <section class="card video-section">
      <div class="card-header">
        <div>
          <h2>Laboratori (Matlab · 3 CFU)</h2>
          <span>Player stile YouTube · ordine cronologico · segna come visto</span>
        </div>
      </div>
      <div class="card-body">
        <div class="video-player-wrapper">
          <div class="video-iframe-container">
            <iframe
              id="videoPlayerMat"
              src=""
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>
          <div class="video-hint">
            <strong>Nota:</strong> i video sono su Google Drive. Devi essere loggato con l'account abilitato per poterli
            riprodurre. Usa il tasto del player per il <strong>full screen</strong>.
          </div>
        </div>

        <div class="video-controls-row">
          <div class="video-nav">
            <button id="prevVideoBtnMat" class="nav-btn" aria-label="Video precedente">◀</button>
            <span id="videoPositionMat">1 / 1</span>
            <button id="nextVideoBtnMat" class="nav-btn" aria-label="Video successivo">▶</button>
          </div>
          <button id="markSeenBtnMat" class="btn btn-small">✓ Segna come visto</button>
        </div>

        <div class="playlist" id="playlistMat"></div>
      </div>
    </section>

    <!-- POMODORO -->
    <section class="card pomodoro-section">
      <div class="card-header">
        <div>
          <h2>Timer Pomodoro</h2>
          <span>25 minuti · 8 pomodori · reset automatico alle 06:00 (ora locale)</span>
        </div>
      </div>
      <div class="card-body">
        <div id="pomodoro-timer" class="pomodoro-timer">25:00</div>

        <div class="pomodoro-controls">
          <button id="startPauseBtn" class="btn btn-primary">▶ Avvia</button>
          <button id="resetPomodoroBtn" class="btn btn-small">↺ Reset pomodoro</button>
          <button id="resetDayBtn" class="btn btn-small btn-danger">✕ Reset giornata</button>
        </div>

        <div class="pomodoro-progress">
          <div id="pomodoro-count">0 / 8 pomodori</div>
          <div id="pomodoro-dots" class="pomodoro-dots"></div>
        </div>

        <div class="pomodoro-info">
          Ogni <strong>pomodoro</strong> sono 25 minuti di concentrazione totale (niente telefono, niente notifiche).
          Dopo ogni pomodoro fai una <strong>pausa breve di 5 minuti</strong>; dopo 4 pomodori consecutivi, pausa più lunga
          di 15–20 minuti.
        </div>
      </div>
    </section>

    <!-- MATERIALE: FONDAMENTI -->
    <section class="card notes-section" id="materialFondSection">
      <div class="card-header">
        <div>
          <h2>Materiale (Fondamenti · 6 CFU)</h2>
          <span>Anteprima stile player + griglia risorse</span>
        </div>
      </div>
      <div class="card-body">
        <div class="material-preview-wrapper">
          <div class="material-iframe-container">
            <iframe id="materialPreviewFond" src="" allow="fullscreen"></iframe>
          </div>
          <div class="material-hint">
            <span><strong>Anteprima materiale</strong> · clicca una card nella griglia per vedere il file qui sopra.</span>
            <span class="material-info" id="materialInfoFond">Nessun file selezionato.</span>
          </div>
        </div>


        <div class="notes-group">
          <div class="notes-group-title">
            <h3>1. Dispense &amp; slide (Fondamenti)</h3>
            <span>PDF su Google Drive / Classroom</span>
          </div>
          <div class="resources-grid">

            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1qHyze_tOLA30MqZCeylSvguEpV3NG6mc/view?usp=classroom_web&amp;authuser=3"
              data-title="FdA 1.1 - Introduzione al corso"
              data-date="24 feb 2025"
              data-type="FdA 1.1"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA 1.1 - Introduzione al corso</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1qHyze_tOLA30MqZCeylSvguEpV3NG6mc/view?usp=classroom_web&amp;authuser=3"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">FdA 1.1</span>
                  <span class="resource-date">24 feb 2025</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1ES4jRYVkcyDMQFGBXCUNC7d9Si8wLH8h/view"
              data-title="FdA 1.2 - Modellazione di sistemi dinamici"
              data-date="26 feb 2025 (Ultima modifica: 6 mar 2025)"
              data-type="FdA 1.2"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA 1.2 - Modellazione di sistemi dinamici</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1ES4jRYVkcyDMQFGBXCUNC7d9Si8wLH8h/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">FdA 1.2</span>
                  <span class="resource-date">26 feb 2025 (Ultima modifica: 6 mar 2025)</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1eyNyocntWBKVRKzJ3T9fTkbaPMeHDEqw/view"
              data-title="FdA 2.1 - Funzioni di Trasferimento"
              data-date="26 mar 2025"
              data-type="FdA 2.1"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA 2.1 - Funzioni di Trasferimento</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1eyNyocntWBKVRKzJ3T9fTkbaPMeHDEqw/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">FdA 2.1</span>
                  <span class="resource-date">26 mar 2025</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1_hz9W8Dzuo_ndRvlA1PTZPhpKpVxAStx/view"
              data-title="FdA 2.2 - Risposta di sistemi elementari"
              data-date="7 apr 2025"
              data-type="FdA 2.2"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA 2.2 - Risposta di sistemi elementari</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1_hz9W8Dzuo_ndRvlA1PTZPhpKpVxAStx/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">FdA 2.2</span>
                  <span class="resource-date">7 apr 2025</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1nY5rQW_idIFjF95f24IjFk8TRgFZIBYV/view"
              data-title="FdA 2.3 - Diagrammi di Bode"
              data-date="15 apr 2025"
              data-type="FdA 2.3"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA 2.3 - Diagrammi di Bode</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1nY5rQW_idIFjF95f24IjFk8TRgFZIBYV/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">FdA 2.3</span>
                  <span class="resource-date">15 apr 2025</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1S0ZByKxGcZmNja2YQ8ZsSXo5R8glOGlP/view"
              data-title="FdA 2.4 - Criteri di stabilità (Routh, Nyquist), errore a regime e luogo delle radici"
              data-date="7 mag 2025"
              data-type="FdA 2.4"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA 2.4 - Criteri di stabilità (Routh, Nyquist), errore a regime e luogo delle radici</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1S0ZByKxGcZmNja2YQ8ZsSXo5R8glOGlP/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">FdA 2.4</span>
                  <span class="resource-date">7 mag 2025</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1A0t5AX2ZwsaA0lDLv0pmgrWbJ76Jcbpl/view"
              data-title="FdA 3.1 (per 9 CFU) - Reti correttrici"
              data-date="20 mag 2025"
              data-type="FdA 3.1 (per 9 CFU)"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA 3.1 (per 9 CFU) - Reti correttrici</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1A0t5AX2ZwsaA0lDLv0pmgrWbJ76Jcbpl/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">FdA 3.1 (per 9 CFU)</span>
                  <span class="resource-date">20 mag 2025</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/13JyIPGdPq107Mi7idTf-0Ths2LJ23zwC/view"
              data-title="FdA 3.2 (per 9 CFU) - Regolatori PID"
              data-date="20 mag 2025"
              data-type="FdA 3.2 (per 9 CFU)"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA 3.2 (per 9 CFU) - Regolatori PID</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/13JyIPGdPq107Mi7idTf-0Ths2LJ23zwC/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">FdA 3.2 (per 9 CFU)</span>
                  <span class="resource-date">20 mag 2025</span>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div class="notes-group">
          <div class="notes-group-title">
            <h3>2. Link esterni citati a lezione</h3>
            <span>YouTube / risorse online</span>
          </div>
          <div class="resources-grid">

            <div
              class="resource-card"
              data-url="https://controlsystemsacademy.com/0007/0007.html"
              data-title="Simulazioni di sistemi con controllo PI"
              data-date="N/D"
              data-type="Link"
              data-no-preview="true"
            >
              <div class="resource-icon ext-zip">LINK</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">Simulazioni di sistemi con controllo PI</div>
                  <a
                    class="resource-open"
                    href="https://controlsystemsacademy.com/0007/0007.html"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://doc.synapticon.com/node/sw5.0/motion_control/control_loops/dual_loop_cascaded_position_control.html"
              data-title="doc.synapticon.com"
              data-date="N/D"
              data-type="Link"
              data-no-preview="true"
            >
              <div class="resource-icon ext-zip">LINK</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">doc.synapticon.com</div>
                  <a
                    class="resource-open"
                    href="https://doc.synapticon.com/node/sw5.0/motion_control/control_loops/dual_loop_cascaded_position_control.html"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://emanual.robotis.com/docs/en/dxl/x/xl330-m288/"
              data-title="emanual.robotis.com"
              data-date="N/D"
              data-type="Link"
              data-no-preview="true"
            >
              <div class="resource-icon ext-zip">LINK</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">emanual.robotis.com</div>
                  <a
                    class="resource-open"
                    href="https://emanual.robotis.com/docs/en/dxl/x/xl330-m288/"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://engineeringmedia.com/map-of-control"
              data-title="Riepilogo dello svolgimento del corso e relazione con la &quot;mappa dell&#x27;Automatica&quot;"
              data-date="N/D"
              data-type="Link"
              data-no-preview="true"
            >
              <div class="resource-icon ext-zip">LINK</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">Riepilogo dello svolgimento del corso e relazione con la &quot;mappa dell&#x27;Automatica&quot;</div>
                  <a
                    class="resource-open"
                    href="https://engineeringmedia.com/map-of-control"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://www.youtube.com/watch?v=2HUDWykabco"
              data-title="youtube.com"
              data-date="N/D"
              data-type="Link"
              data-no-preview="false"
            >
              <div class="resource-icon ext-ppt">YT</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">youtube.com</div>
                  <a
                    class="resource-open"
                    href="https://www.youtube.com/watch?v=2HUDWykabco"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://www.youtube.com/watch?v=9k7RZbe72Mo"
              data-title="Applicazioni mediche dei robot collaborativi (derivanti dall&#x27;industria!)"
              data-date="N/D"
              data-type="Link"
              data-no-preview="false"
            >
              <div class="resource-icon ext-ppt">YT</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">Applicazioni mediche dei robot collaborativi (derivanti dall&#x27;industria!)</div>
                  <a
                    class="resource-open"
                    href="https://www.youtube.com/watch?v=9k7RZbe72Mo"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://www.youtube.com/watch?v=LAtPHANEfQo"
              data-title="Modello del motore a corrente continua"
              data-date="N/D"
              data-type="Link"
              data-no-preview="false"
            >
              <div class="resource-icon ext-ppt">YT</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">Modello del motore a corrente continua</div>
                  <a
                    class="resource-open"
                    href="https://www.youtube.com/watch?v=LAtPHANEfQo"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://www.youtube.com/watch?v=coQyr06dDK8"
              data-title="youtube.com"
              data-date="N/D"
              data-type="Link"
              data-no-preview="false"
            >
              <div class="resource-icon ext-ppt">YT</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">youtube.com</div>
                  <a
                    class="resource-open"
                    href="https://www.youtube.com/watch?v=coQyr06dDK8"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://www.youtube.com/watch?v=hg3TIFIxWCo"
              data-title="youtube.com"
              data-date="N/D"
              data-type="Link"
              data-no-preview="false"
            >
              <div class="resource-icon ext-ppt">YT</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">youtube.com</div>
                  <a
                    class="resource-open"
                    href="https://www.youtube.com/watch?v=hg3TIFIxWCo"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://www.youtube.com/watch?v=mZ-L6FzX3yE"
              data-title="Impianto assemblaggio automobili"
              data-date="N/D"
              data-type="Link"
              data-no-preview="false"
            >
              <div class="resource-icon ext-ppt">YT</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">Impianto assemblaggio automobili</div>
                  <a
                    class="resource-open"
                    href="https://www.youtube.com/watch?v=mZ-L6FzX3yE"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://www.youtube.com/watch?v=r7gU74Yv9Es"
              data-title="&quot;Programmazione&quot; a guida manuale di robot collaborativi"
              data-date="N/D"
              data-type="Link"
              data-no-preview="false"
            >
              <div class="resource-icon ext-ppt">YT</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">&quot;Programmazione&quot; a guida manuale di robot collaborativi</div>
                  <a
                    class="resource-open"
                    href="https://www.youtube.com/watch?v=r7gU74Yv9Es"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://www.youtube.com/watch?v=ym64NFCWORY"
              data-title="Cella di assemblaggio motherboard di PC"
              data-date="N/D"
              data-type="Link"
              data-no-preview="false"
            >
              <div class="resource-icon ext-ppt">YT</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">Cella di assemblaggio motherboard di PC</div>
                  <a
                    class="resource-open"
                    href="https://www.youtube.com/watch?v=ym64NFCWORY"
                    target="_blank"
                    rel="noopener"
                    title="Apri link esterno"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Link</span>
                  <span class="resource-date">N/D</span>
                </div>
              </div>
            </div>

          </div>
        </div>

      </div>
    </section>

    <!-- MATERIALE: MATLAB -->
    <section class="card notes-section" id="materialMatSection">
      <div class="card-header">
        <div>
          <h2>Materiale (Matlab · 3 CFU)</h2>
          <span>Anteprima stile player + griglia risorse</span>
        </div>
      </div>
      <div class="card-body">
        <div class="material-preview-wrapper">
          <div class="material-iframe-container">
            <iframe id="materialPreviewMat" src="" allow="fullscreen"></iframe>
          </div>
          <div class="material-hint">
            <span><strong>Anteprima materiale</strong> · clicca una card nella griglia per vedere il file qui sopra.</span>
            <span class="material-info" id="materialInfoMat">Nessun file selezionato.</span>
          </div>
        </div>


        <div class="notes-group">
          <div class="notes-group-title">
            <h3>1. Materiale Matlab</h3>
            <span>PDF su Google Drive</span>
          </div>
          <div class="resources-grid">

            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1LGR1nZsbn4GKlN0iT4gbG-5YODwGEYSM/view"
              data-title="FdA Matlab 1 - Introduzione · File 1"
              data-date="17 mar 2025 (Ultima modifica: 1 apr 2025)"
              data-type="Matlab"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA Matlab 1 - Introduzione · File 1</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1LGR1nZsbn4GKlN0iT4gbG-5YODwGEYSM/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Matlab</span>
                  <span class="resource-date">17 mar 2025 (Ultima modifica: 1 apr 2025)</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1nIVf3p8GNFNUvCgzanFXqB4pqoUOEu5N/view"
              data-title="FdA Matlab 1 - Introduzione · File 2"
              data-date="17 mar 2025 (Ultima modifica: 1 apr 2025)"
              data-type="Matlab"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA Matlab 1 - Introduzione · File 2</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1nIVf3p8GNFNUvCgzanFXqB4pqoUOEu5N/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Matlab</span>
                  <span class="resource-date">17 mar 2025 (Ultima modifica: 1 apr 2025)</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1yyaC4aPeAbqMot40cvYDJCAkin0Zee9b/view"
              data-title="FdA Matlab 2 - Trasformate di Laplace · File 1"
              data-date="31 mar 2025 (Ultima modifica: 8 apr 2025)"
              data-type="Matlab"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA Matlab 2 - Trasformate di Laplace · File 1</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1yyaC4aPeAbqMot40cvYDJCAkin0Zee9b/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Matlab</span>
                  <span class="resource-date">31 mar 2025 (Ultima modifica: 8 apr 2025)</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1QIXgqJa79x5Tuce7cH0GqA849PM78V-M/view"
              data-title="FdA Matlab 2 - Trasformate di Laplace · File 2"
              data-date="31 mar 2025 (Ultima modifica: 8 apr 2025)"
              data-type="Matlab"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA Matlab 2 - Trasformate di Laplace · File 2</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1QIXgqJa79x5Tuce7cH0GqA849PM78V-M/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Matlab</span>
                  <span class="resource-date">31 mar 2025 (Ultima modifica: 8 apr 2025)</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1fa75YEH6zL4yQHadObxa3QhnqwhfqZQR/view"
              data-title="FdA Matlab 3 - Diagrammi a blocchi"
              data-date="7 apr 2025"
              data-type="Matlab"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA Matlab 3 - Diagrammi a blocchi</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1fa75YEH6zL4yQHadObxa3QhnqwhfqZQR/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Matlab</span>
                  <span class="resource-date">7 apr 2025</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1aCaGnJsdCc2pvNW_dlB_IOX84J-DyyvB/view"
              data-title="FdA Matlab 4 - Risposta di FdT · File 1"
              data-date="15 apr 2025 (Ultima modifica: 15 apr 2025)"
              data-type="Matlab"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA Matlab 4 - Risposta di FdT · File 1</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1aCaGnJsdCc2pvNW_dlB_IOX84J-DyyvB/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Matlab</span>
                  <span class="resource-date">15 apr 2025 (Ultima modifica: 15 apr 2025)</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1wzkVQq79orm9FairDFpk8oAAYOMAXJLw/view"
              data-title="FdA Matlab 4 - Risposta di FdT · File 2"
              data-date="15 apr 2025 (Ultima modifica: 15 apr 2025)"
              data-type="Matlab"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">FdA Matlab 4 - Risposta di FdT · File 2</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1wzkVQq79orm9FairDFpk8oAAYOMAXJLw/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Matlab</span>
                  <span class="resource-date">15 apr 2025 (Ultima modifica: 15 apr 2025)</span>
                </div>
              </div>
            </div>


            <div
              class="resource-card"
              data-url="https://drive.google.com/file/d/1wnFdRmUMKjUn2w7TBBqLpIpM4PyDg8Mw/view"
              data-title="Matlab Cheatsheet"
              data-date="15 apr 2025"
              data-type="Matlab"
              data-no-preview="false"
            >
              <div class="resource-icon ext-pdf">PDF</div>
              <div class="resource-content">
                <div class="resource-header">
                  <div class="resource-title">Matlab Cheatsheet</div>
                  <a
                    class="resource-open"
                    href="https://drive.google.com/file/d/1wnFdRmUMKjUn2w7TBBqLpIpM4PyDg8Mw/view"
                    target="_blank"
                    rel="noopener"
                    title="Apri"
                  >↗</a>
                </div>
                <div class="resource-meta">
                  <span class="resource-pill">Matlab</span>
                  <span class="resource-date">15 apr 2025</span>
                </div>
              </div>
            </div>

          </div>
        </div>

      </div>
    </section>

    <!-- WALKTHROUGH -->
    <section class="card walkthrough-section">
      <div class="card-header">
        <div>
          <h2>Walkthrough per studiare in modo sostenibile</h2>
          <span>Routine consigliata (Fondamenti + Matlab)</span>
        </div>
      </div>
      <div class="card-body">
        <ol>
          <li>
            <strong>Setup (5 minuti)</strong>
            <ul>
              <li>Apri il <strong>timer pomodoro</strong> e imposta un obiettivo (es. 2 pomodori = 1 lezione + 10 minuti di ripasso).</li>
              <li>Scegli <strong>una lezione</strong> dal player e tieni aperte le <strong>slide/dispense</strong> correlate nella sezione materiale.</li>
            </ul>
          </li>
          <li>
            <strong>Visione lezione (1–2 pomodori)</strong>
            <ul>
              <li>Guarda la lezione con ritmo continuo: pause solo sui passaggi chiave.</li>
              <li>Scrivi 5–10 righe di appunti: definizioni, proprietà, passaggi che ricompaiono negli esercizi.</li>
              <li>Alla fine, segna il video come <strong>visto</strong>.</li>
            </ul>
          </li>
          <li>
            <strong>Consolidamento (1 pomodoro)</strong>
            <ul>
              <li>Riapri le slide e riscrivi gli appunti in forma “pulita” (formule + significato fisico).</li>
              <li>Fai 2–3 esercizi brevi o riprendi i passaggi svolti in aula.</li>
            </ul>
          </li>
          <li>
            <strong>Parte Matlab (1–2 pomodori)</strong>
            <ul>
              <li>Guarda un <strong>laboratorio</strong> e replica i comandi in Matlab, senza copiare a memoria.</li>
              <li>Costruisci un mini–“template” riutilizzabile (es. calcolo e^{At}, controllabilità/osservabilità, Laplace).</li>
            </ul>
          </li>
          <li>
            <strong>Ripasso settimanale (2–3 pomodori)</strong>
            <ul>
              <li>Rivedi le lezioni più “dense” e fai esercizi tipo-esame a tempo.</li>
              <li>Se un argomento torna spesso (stabilità, FdT, Bode, Routh/Nyquist), rivedi la lezione + una sessione di esercizi.</li>
            </ul>
          </li>
        </ol>
      </div>
    </section>
  </main>

  <script>

    // --- DATI VIDEO (ordine cronologico) ---
    const videosFondamenti = [
  {
    "id": 1,
    "title": "Lezione 1 · Video 1",
    "dateLabel": "Lezione 1",
    "url": "https://drive.google.com/file/d/1mQ1r2kDNuMmvdCgJa_REcErafCjE8qkt/view",
    "type": "lesson",
    "date": "26 feb 2025"
  },
  {
    "id": 2,
    "title": "Lezione 1 · Video 2",
    "dateLabel": "Lezione 1",
    "url": "https://drive.google.com/file/d/1TmxvSFzXZ3_8S6H3Ejiaiud1dZtwMQQ4/view",
    "type": "lesson",
    "date": "26 feb 2025"
  },
  {
    "id": 3,
    "title": "Lezione 2 · Video 1",
    "dateLabel": "Lezione 2",
    "url": "https://drive.google.com/file/d/1O0x5m-bAthyEkmp6wMpHMuk2x3D9F3F_/view",
    "type": "lesson",
    "date": "26 feb 2025"
  },
  {
    "id": 4,
    "title": "Lezione 2 · Video 2",
    "dateLabel": "Lezione 2",
    "url": "https://drive.google.com/file/d/1SbWDqALRzE3Mc1gICvDi_p-5gcVFe99n/view",
    "type": "lesson",
    "date": "26 feb 2025"
  },
  {
    "id": 5,
    "title": "Lezione 3 · Video 1",
    "dateLabel": "Lezione 3",
    "url": "https://drive.google.com/file/u/3/d/10CdcVXJe12DKW4ngXLCHgsDUGzy5-BxI/view?usp=classroom_web",
    "type": "lesson",
    "date": "27 feb 2025 (Ultima modifica: 27 feb 2025)"
  },
  {
    "id": 6,
    "title": "Lezione 3 · Video 2",
    "dateLabel": "Lezione 3",
    "url": "https://drive.google.com/file/d/1Z8I3S-YZKJ9xY0K8DhPisqPjvMcA0yA2/view",
    "type": "lesson",
    "date": "27 feb 2025 (Ultima modifica: 27 feb 2025)"
  },
  {
    "id": 7,
    "title": "Lezione 4 · Video 1",
    "dateLabel": "Lezione 4",
    "url": "https://drive.google.com/file/d/1j0Sf_WceGiDxBupWUmPjhfbJwwE6o7_m/view",
    "type": "lesson",
    "date": "5 mar 2025"
  },
  {
    "id": 8,
    "title": "Lezione 4 · Video 2",
    "dateLabel": "Lezione 4",
    "url": "https://drive.google.com/file/d/1gD0BlpaFPWu-LdetSEPQNfLkwZ2g4whD/view",
    "type": "lesson",
    "date": "5 mar 2025"
  },
  {
    "id": 9,
    "title": "Lezione 5 · Video 1",
    "dateLabel": "Lezione 5",
    "url": "https://drive.google.com/file/d/1jQLSdgNHWg-5vCn14w4FqoXJqWey0J5y/view",
    "type": "lesson",
    "date": "5 mar 2025"
  },
  {
    "id": 10,
    "title": "Lezione 5 · Video 2",
    "dateLabel": "Lezione 5",
    "url": "https://drive.google.com/file/d/1UaAnlScmz9BsDMlNaEAMhOOxXSLn2CdK/view",
    "type": "lesson",
    "date": "5 mar 2025"
  },
  {
    "id": 11,
    "title": "Lezione 6 · Video 1",
    "dateLabel": "Lezione 6",
    "url": "https://drive.google.com/file/d/1dx149nxvyjANr3xSna5SWvAJ2-0m2WzX/view",
    "type": "lesson",
    "date": "6 mar 2025"
  },
  {
    "id": 12,
    "title": "Lezione 6 · Video 2",
    "dateLabel": "Lezione 6",
    "url": "https://drive.google.com/file/d/1a3PaiUdCp2otwzDUsIIkDHzm6mDgcJxQ/view",
    "type": "lesson",
    "date": "6 mar 2025"
  },
  {
    "id": 13,
    "title": "Lezione 7 · Video 1",
    "dateLabel": "Lezione 7",
    "url": "https://drive.google.com/file/d/1Om62BsL7h-WKGF7I4ya_agOmIGhRnu-M/view?usp=classroom_web&authuser=3",
    "type": "lesson",
    "date": "12 mar 2025"
  },
  {
    "id": 14,
    "title": "Lezione 7 · Video 2",
    "dateLabel": "Lezione 7",
    "url": "https://drive.google.com/file/d/113QDOfGH9lrP2ROeaOfD8wrtJblB6iDJ/view",
    "type": "lesson",
    "date": "12 mar 2025"
  },
  {
    "id": 15,
    "title": "Lezione 8 · Video 1",
    "dateLabel": "Lezione 8",
    "url": "https://drive.google.com/file/d/1tJ-iRKs37YtJRlHT30JYjjpUfJf_chcp/view",
    "type": "lesson",
    "date": "13 mar 2025"
  },
  {
    "id": 16,
    "title": "Lezione 8 · Video 2",
    "dateLabel": "Lezione 8",
    "url": "https://drive.google.com/file/d/1hhh91yrMLposN0oR2dJjUd0EXCrEAvg_/view",
    "type": "lesson",
    "date": "13 mar 2025"
  },
  {
    "id": 17,
    "title": "Lezione 9 · Video 1",
    "dateLabel": "Lezione 9",
    "url": "https://drive.google.com/file/d/1kdKzLwLF_4hJGVZNrGW0FJbwgB8Alc3Q/view",
    "type": "lesson",
    "date": "13 mar 2025"
  },
  {
    "id": 18,
    "title": "Lezione 9 · Video 2",
    "dateLabel": "Lezione 9",
    "url": "https://drive.google.com/file/d/16aC9Rwpixh9zSwjQDAa7yQ6pS92jMYYy/view",
    "type": "lesson",
    "date": "13 mar 2025"
  },
  {
    "id": 19,
    "title": "Lezione 10 · Video 1",
    "dateLabel": "Lezione 10",
    "url": "https://drive.google.com/file/d/1CSQOOFqhEeqO80PH5mSocDFd1NQoVdma/view",
    "type": "lesson",
    "date": "19 mar 2025"
  },
  {
    "id": 20,
    "title": "Lezione 10 · Video 2",
    "dateLabel": "Lezione 10",
    "url": "https://drive.google.com/file/d/11j2J9pJTcdvxoNhrqFQPpYWkSIE6_OaB/view",
    "type": "lesson",
    "date": "19 mar 2025"
  },
  {
    "id": 21,
    "title": "Lezione 11 · Video 1",
    "dateLabel": "Lezione 11",
    "url": "https://drive.google.com/file/d/1QgIVG3aglLIZ61b212mlx3ZPU-z617_g/view",
    "type": "lesson",
    "date": "20 mar 2025"
  },
  {
    "id": 22,
    "title": "Lezione 11 · Video 2",
    "dateLabel": "Lezione 11",
    "url": "https://drive.google.com/file/d/12LEqw9-6K5ma3H7LluDzG2MemwXXzkw1/view",
    "type": "lesson",
    "date": "20 mar 2025"
  },
  {
    "id": 23,
    "title": "Lezione 12 · Video 1",
    "dateLabel": "Lezione 12",
    "url": "https://drive.google.com/file/d/18k2IYagoHPV9MCo38t99Xw3AQWVr9hR-/view",
    "type": "lesson",
    "date": "26 mar 2025"
  },
  {
    "id": 24,
    "title": "Lezione 12 · Video 2",
    "dateLabel": "Lezione 12",
    "url": "https://drive.google.com/file/d/1HmQmsyir1bjAM0_i_MwLcuQDSWUZY8N5/view",
    "type": "lesson",
    "date": "26 mar 2025"
  },
  {
    "id": 25,
    "title": "Lezione 13 · Video 1",
    "dateLabel": "Lezione 13",
    "url": "https://drive.google.com/file/d/12bCq4LwEf2f2QRq9KD2h0Q6i9iSva94N/view",
    "type": "lesson",
    "date": "27 mar 2025"
  },
  {
    "id": 26,
    "title": "Lezione 13 · Video 2",
    "dateLabel": "Lezione 13",
    "url": "https://drive.google.com/file/d/12HSOYrjJSzvTBKOxw2X5pAW3YP-1y6td/view",
    "type": "lesson",
    "date": "27 mar 2025"
  },
  {
    "id": 27,
    "title": "Lezione 14 · Video 1",
    "dateLabel": "Lezione 14",
    "url": "https://drive.google.com/file/d/1t8wgMbdaprJ4jVYhzaFvIuceAn_1QKW_/view",
    "type": "lesson",
    "date": "3 apr 2025"
  },
  {
    "id": 28,
    "title": "Lezione 14 · Video 2",
    "dateLabel": "Lezione 14",
    "url": "https://drive.google.com/file/d/1lsOkYyje_QolK6qcIHxO2IRfvX9C81eg/view",
    "type": "lesson",
    "date": "3 apr 2025"
  },
  {
    "id": 29,
    "title": "Lezione 15 · Video 1",
    "dateLabel": "Lezione 15",
    "url": "https://drive.google.com/file/d/11PIS_sMh9jT_mgbVZ0OPa2OdL4rALYrY/view",
    "type": "lesson",
    "date": "3 apr 2025 (Ultima modifica: 9 apr 2025)"
  },
  {
    "id": 30,
    "title": "Lezione 15 · Video 2",
    "dateLabel": "Lezione 15",
    "url": "https://drive.google.com/file/d/181MwgPViwbh5LR5xL7ZUGc2LSoowU3nM/view",
    "type": "lesson",
    "date": "3 apr 2025 (Ultima modifica: 9 apr 2025)"
  },
  {
    "id": 31,
    "title": "Lezione 16 · Video 1",
    "dateLabel": "Lezione 16",
    "url": "https://drive.google.com/file/d/1iemq8iJBQxqr7GOoxDpJQirPPA2NCK_j/view",
    "type": "lesson",
    "date": "9 apr 2025 (Ultima modifica: 9 apr 2025)"
  },
  {
    "id": 32,
    "title": "Lezione 16 · Video 2",
    "dateLabel": "Lezione 16",
    "url": "https://drive.google.com/file/d/1_R29yT0UhSpVqiQ_q1ORm8AxKJ7lkWew/view",
    "type": "lesson",
    "date": "9 apr 2025 (Ultima modifica: 9 apr 2025)"
  },
  {
    "id": 33,
    "title": "Lezione 17 · Video 1",
    "dateLabel": "Lezione 17",
    "url": "https://drive.google.com/file/d/1ucaI43hICibxY2PBsU8IbKyN_IdZLhjP/view",
    "type": "lesson",
    "date": "10 apr 2025"
  },
  {
    "id": 34,
    "title": "Lezione 17 · Video 2",
    "dateLabel": "Lezione 17",
    "url": "https://drive.google.com/file/d/1WAkIEDdRpdvDJGNmyH36Uh7hxVMTDb3J/view",
    "type": "lesson",
    "date": "10 apr 2025"
  },
  {
    "id": 35,
    "title": "Lezione 18 · Video 1",
    "dateLabel": "Lezione 18",
    "url": "https://drive.google.com/file/d/1le7wvtOlJlAGk6F8T7JaZHrfz_DASuvO/view",
    "type": "lesson",
    "date": "16 apr 2025 (Ultima modifica: 6 mag 2025)"
  },
  {
    "id": 36,
    "title": "Lezione 18 · Video 2",
    "dateLabel": "Lezione 18",
    "url": "https://drive.google.com/file/d/1R0bNyQTsPhCXS3WoqZ50IAzJF5X-Kq3q/view",
    "type": "lesson",
    "date": "16 apr 2025 (Ultima modifica: 6 mag 2025)"
  },
  {
    "id": 37,
    "title": "Lezione 19 · Video 1",
    "dateLabel": "Lezione 19",
    "url": "https://drive.google.com/file/d/1UihAgroqhmyEIISVNEfXugNsnUtWipBo/view",
    "type": "lesson",
    "date": "7 mag 2025"
  },
  {
    "id": 38,
    "title": "Lezione 19 · Video 2",
    "dateLabel": "Lezione 19",
    "url": "https://drive.google.com/file/d/1aeR4D1Dx4qEfA8R4Od7GGFI57MXVGx-F/view",
    "type": "lesson",
    "date": "7 mag 2025"
  },
  {
    "id": 39,
    "title": "Lezione 20 · Video 1",
    "dateLabel": "Lezione 20",
    "url": "https://drive.google.com/file/d/1RKybMSrlcJtXR_fRZ-Vno2ATgrdq2vqy/view",
    "type": "lesson",
    "date": "9 mag 2025 (Ultima modifica: 14 mag 2025)"
  },
  {
    "id": 40,
    "title": "Lezione 20 · Video 2",
    "dateLabel": "Lezione 20",
    "url": "https://drive.google.com/file/d/1h3UNcO8hGR1EkirVMV6LP34AlRvaH-DX/view",
    "type": "lesson",
    "date": "9 mag 2025 (Ultima modifica: 14 mag 2025)"
  },
  {
    "id": 41,
    "title": "Lezione 21 · Video 1",
    "dateLabel": "Lezione 21",
    "url": "https://drive.google.com/file/d/1JaEwCIuSrDXf5S3-6Mis3hUXTr8uHhUC/view",
    "type": "lesson",
    "date": "13 mag 2025"
  },
  {
    "id": 42,
    "title": "Lezione 21 · Video 2",
    "dateLabel": "Lezione 21",
    "url": "https://drive.google.com/file/d/1wvNVzLIX-TDPEzN3RQdSR5tqDHoMSfQ9/view",
    "type": "lesson",
    "date": "13 mag 2025"
  },
  {
    "id": 43,
    "title": "Lezione 22 · Video 1",
    "dateLabel": "Lezione 22",
    "url": "https://drive.google.com/file/d/1lrkVVfAMWGF_vnd5Js0m84pVTVosLjd4/view",
    "type": "lesson",
    "date": "14 mag 2025"
  },
  {
    "id": 44,
    "title": "Lezione 22 · Video 2",
    "dateLabel": "Lezione 22",
    "url": "https://drive.google.com/file/d/1rj_vFzfWgBOBd_jbwC1FdcfNK3fOVcXc/view",
    "type": "lesson",
    "date": "14 mag 2025"
  },
  {
    "id": 45,
    "title": "Lezione 23 · Video 1",
    "dateLabel": "Lezione 23",
    "url": "https://drive.google.com/file/d/1cshdM3z8slbfl9VqxaN2e1boU26l1OXB/view",
    "type": "lesson",
    "date": "15 mag 2025"
  },
  {
    "id": 46,
    "title": "Lezione 23 · Video 2",
    "dateLabel": "Lezione 23",
    "url": "https://drive.google.com/file/d/17LLOit_DizCMQzXxsXnHI_LlrPFoJGbx/view",
    "type": "lesson",
    "date": "15 mag 2025"
  },
  {
    "id": 47,
    "title": "Lezione 24 · Video 1",
    "dateLabel": "Lezione 24",
    "url": "https://drive.google.com/file/d/1QnJejax1bPiqEgVbqW_gnNZlFtIkT8Ew/view",
    "type": "lesson",
    "date": "21 mag 2025"
  },
  {
    "id": 48,
    "title": "Lezione 24 · Video 2",
    "dateLabel": "Lezione 24",
    "url": "https://drive.google.com/file/d/1LmHEONNm3t5l7U6T2UJ739J0fIpGrcIj/view",
    "type": "lesson",
    "date": "21 mag 2025"
  },
  {
    "id": 49,
    "title": "Lezione 25 (per 9 CFU) · Video 1",
    "dateLabel": "Lezione 25 (per 9 CFU)",
    "url": "https://drive.google.com/file/d/1cNLLodgDrVHfQHH3NGcOPmS0HFW_6XbG/view",
    "type": "lesson",
    "date": "26 mag 2025"
  },
  {
    "id": 50,
    "title": "Lezione 25 (per 9 CFU) · Video 2",
    "dateLabel": "Lezione 25 (per 9 CFU)",
    "url": "https://drive.google.com/file/d/169VzVgYXpl7EmzR1NS1GsoPgARgPAUSn/view",
    "type": "lesson",
    "date": "26 mag 2025"
  },
  {
    "id": 51,
    "title": "Lezione 26 (per 9 CFU) · Video 1",
    "dateLabel": "Lezione 26 (per 9 CFU)",
    "url": "https://drive.google.com/file/d/1Mm7Cdjhdrb8dIjgCI-xZfsGjoBTjH9gT/view",
    "type": "lesson",
    "date": "29 mag 2025"
  },
  {
    "id": 52,
    "title": "Lezione 26 (per 9 CFU) · Video 2",
    "dateLabel": "Lezione 26 (per 9 CFU)",
    "url": "https://drive.google.com/file/d/1o24rR26PPAVMfBjKbYI2JfCCMwY-N3oW/view",
    "type": "lesson",
    "date": "29 mag 2025"
  },
  {
    "id": 53,
    "title": "Lezione 27 (per 9 CFU) · Video 1",
    "dateLabel": "Lezione 27 (per 9 CFU)",
    "url": "https://drive.google.com/file/d/14cCE9_2NgOsbDtKo36crs32gPLK2s2Xx/view",
    "type": "lesson",
    "date": "29 mag 2025"
  },
  {
    "id": 54,
    "title": "Lezione 27 (per 9 CFU) · Video 2",
    "dateLabel": "Lezione 27 (per 9 CFU)",
    "url": "https://drive.google.com/file/d/13FTzONXWc6rq2mYndlunC9O_blrvaFS4/view",
    "type": "lesson",
    "date": "29 mag 2025"
  }
];

    const videosMatlab = [
  {
    "id": 1,
    "title": "Laboratorio Matlab 1 · Video 1",
    "dateLabel": "Laboratorio Matlab 1",
    "url": "https://drive.google.com/file/d/1j94Yqvc7mYg6oJyTMKxTZXBkSbTHRgO6/view",
    "type": "lab",
    "date": "18 mar 2025"
  },
  {
    "id": 2,
    "title": "Laboratorio Matlab 1 · Video 2",
    "dateLabel": "Laboratorio Matlab 1",
    "url": "https://drive.google.com/file/d/1ztr8f5Ftgv_-fNruFFGPboTjT2Nbwm4V/view",
    "type": "lab",
    "date": "18 mar 2025"
  },
  {
    "id": 3,
    "title": "Laboratorio Matlab 2 · Video 1",
    "dateLabel": "Laboratorio Matlab 2",
    "url": "https://drive.google.com/file/d/1V3cBeo6RSVlVJppleafsE4NCXwO2mww_/view",
    "type": "lab",
    "date": "1 apr 2025"
  },
  {
    "id": 4,
    "title": "Laboratorio Matlab 2 · Video 2",
    "dateLabel": "Laboratorio Matlab 2",
    "url": "https://drive.google.com/file/d/1UPIvXBluxHICT_TxfSDiX95vJDOJmwTs/view",
    "type": "lab",
    "date": "1 apr 2025"
  },
  {
    "id": 5,
    "title": "Laboratorio Matlab 3 · Video 1",
    "dateLabel": "Laboratorio Matlab 3",
    "url": "https://drive.google.com/file/d/16y0i-VEgdXMi08K1Gt_IAFVrxgso_j81/view",
    "type": "lab",
    "date": "7 apr 2025"
  },
  {
    "id": 6,
    "title": "Laboratorio Matlab 3 · Video 2",
    "dateLabel": "Laboratorio Matlab 3",
    "url": "https://drive.google.com/file/d/1XDcib3Y2u00F8uF-rr83SC-H9aZSYpgI/view",
    "type": "lab",
    "date": "7 apr 2025"
  },
  {
    "id": 7,
    "title": "Laboratorio Matlab 4 · Video 1",
    "dateLabel": "Laboratorio Matlab 4",
    "url": "https://drive.google.com/file/d/1cE9isEHDhGBw3hB6Gy_zS0rfVgTOOTDu/view",
    "type": "lab",
    "date": "8 apr 2025"
  },
  {
    "id": 8,
    "title": "Laboratorio Matlab 4 · Video 2",
    "dateLabel": "Laboratorio Matlab 4",
    "url": "https://drive.google.com/file/d/12TIvSYAj2pQHakFcqHE_TduDaqTv0WnH/view",
    "type": "lab",
    "date": "8 apr 2025"
  },
  {
    "id": 9,
    "title": "Laboratorio Matlab 5 · Video 1",
    "dateLabel": "Laboratorio Matlab 5",
    "url": "https://drive.google.com/file/d/1DqfLzyZ7d1t-cc7Vuaxaq8tQBmqDq75F/view",
    "type": "lab",
    "date": "15 apr 2025"
  },
  {
    "id": 10,
    "title": "Laboratorio Matlab 5 · Video 2",
    "dateLabel": "Laboratorio Matlab 5",
    "url": "https://drive.google.com/file/d/12ZgAGhIpmkZbBkAf5cftfTK_ZMcABD7p/view",
    "type": "lab",
    "date": "15 apr 2025"
  },
  {
    "id": 11,
    "title": "Laboratorio Matlab 6 · Video 1",
    "dateLabel": "Laboratorio Matlab 6",
    "url": "https://drive.google.com/file/d/1_PLSqPSJVeggoOhfBsj-L9sChXksUFk_/view",
    "type": "lab",
    "date": "6 mag 2025"
  },
  {
    "id": 12,
    "title": "Laboratorio Matlab 6 · Video 2",
    "dateLabel": "Laboratorio Matlab 6",
    "url": "https://drive.google.com/file/d/1vfDmp3MOJknSoLQB5estWi6h4bvqbaY9/view",
    "type": "lab",
    "date": "6 mag 2025"
  },
  {
    "id": 13,
    "title": "Laboratorio Matlab 7 · Video 1",
    "dateLabel": "Laboratorio Matlab 7",
    "url": "https://drive.google.com/file/d/17bqWGNAPk4jwJM1trwC6qnPwOAtEHPya/view",
    "type": "lab",
    "date": "27 mag 2025"
  },
  {
    "id": 14,
    "title": "Laboratorio Matlab 7 · Video 2",
    "dateLabel": "Laboratorio Matlab 7",
    "url": "https://drive.google.com/file/d/1jFc8ITHM_VYpR1hOFlIXURfN098XrUsx/view",
    "type": "lab",
    "date": "27 mag 2025"
  }
];

    function transformDriveUrl(url) {
      if (!url) return "";
      // Google Drive: /view -> /preview (funziona sia per video che PDF)
      if (url.includes("drive.google.com")) {
        return url.replace("/view", "/preview");
      }
      // YouTube: watch?v= -> embed/
      if (url.includes("youtube.com/watch")) {
        return url.replace("watch?v=", "embed/");
      }
      if (url.includes("youtu.be/")) {
        const id = url.split("youtu.be/")[1].split(/[?&]/)[0];
        return "https://www.youtube.com/embed/" + id;
      }
      return url;
    }

    function initVideoSection(cfg) {
      const {
        videos,
        playerId,
        playlistId,
        positionId,
        prevBtnId,
        nextBtnId,
        markSeenBtnId,
        storageKeySeen
      } = cfg;

      const player = document.getElementById(playerId);
      const playlist = document.getElementById(playlistId);
      const positionEl = document.getElementById(positionId);

      if (!player || !playlist || !positionEl) return;

      let currentIndex = 0;
      let seenIds = new Set();

      function loadSeen() {
        try {
          const raw = localStorage.getItem(storageKeySeen);
          if (!raw) {
            seenIds = new Set();
            return;
          }
          const arr = JSON.parse(raw);
          seenIds = new Set(Array.isArray(arr) ? arr : []);
        } catch (e) {
          seenIds = new Set();
        }
      }

      function saveSeen() {
        try {
          localStorage.setItem(storageKeySeen, JSON.stringify(Array.from(seenIds)));
        } catch (e) {}
      }

      function updatePosition() {
        positionEl.textContent = `${currentIndex + 1} / ${videos.length}`;
      }

      function renderPlaylist() {
        playlist.innerHTML = "";
        videos.forEach((video, index) => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "playlist-item";

          if (video.type === "lab") {
            btn.classList.add("lab");
          }

          if (index === currentIndex) {
            btn.classList.add("active");
          }

          if (seenIds.has(video.id) && index !== currentIndex) {
            btn.classList.add("seen");
          }

          let badgeClass = "badge-lesson";
          let badgeLabel = "Lezione";

          if (video.type === "lab") {
            badgeClass = "badge-lab";
            badgeLabel = "Lab";
          }

          const seenLabel = seenIds.has(video.id)
            ? '<span class="seen-flag">✓ visto</span>'
            : "";

          btn.innerHTML = `
            <div class="playlist-thumbnail">
              <div class="play-icon">▶</div>
            </div>
            <div class="playlist-meta">
              <div class="playlist-title">${video.title}</div>
              <div class="playlist-subtitle">
                <span>${video.dateLabel}</span>
                <span class="badge ${badgeClass}">${badgeLabel}</span>
                ${seenLabel}
              </div>
            </div>
          `;

          btn.addEventListener("click", () => {
            currentIndex = index;
            loadVideo(currentIndex);
          });

          playlist.appendChild(btn);
        });
      }

      function loadVideo(index) {
        const video = videos[index];
        if (!video) return;

        player.src = transformDriveUrl(video.url);
        updatePosition();
        renderPlaylist();
      }

      function showPrev() {
        if (currentIndex > 0) {
          currentIndex -= 1;
          loadVideo(currentIndex);
        }
      }

      function showNext() {
        if (currentIndex < videos.length - 1) {
          currentIndex += 1;
          loadVideo(currentIndex);
        }
      }

      function markSeen() {
        const video = videos[currentIndex];
        if (!video) return;
        seenIds.add(video.id);
        saveSeen();
        renderPlaylist();
      }

      // Init
      loadSeen();
      loadVideo(0);

      const prevBtn = document.getElementById(prevBtnId);
      const nextBtn = document.getElementById(nextBtnId);
      const markBtn = document.getElementById(markSeenBtnId);

      if (prevBtn) prevBtn.addEventListener("click", showPrev);
      if (nextBtn) nextBtn.addEventListener("click", showNext);
      if (markBtn) markBtn.addEventListener("click", markSeen);
    }

    // --- POMODORO TIMER (con namespace per non sovrascrivere altre pagine) ---
    const STORAGE_PREFIX = "fondamenti";
    const POMODORO_DURATION = 25 * 60; // 25 minuti in secondi
    const MAX_POMODORI = 8;

    let remainingSeconds = POMODORO_DURATION;
    let isRunning = false;
    let completedPomodori = 0;
    let timerInterval = null;

    function sk(key) {
      return `${STORAGE_PREFIX}_${key}`;
    }

    function getStudyDayId() {
      const now = new Date();
      // Reset alle 06:00 ora locale
      const current = new Date(now.getTime());
      if (current.getHours() < 6) {
        current.setDate(current.getDate() - 1);
      }
      const y = current.getFullYear();
      const m = String(current.getMonth() + 1).padStart(2, "0");
      const d = String(current.getDate()).padStart(2, "0");
      return `${y}-${m}-${d}`;
    }

    function savePomodoroState() {
      localStorage.setItem(sk("pomodoroDayId"), getStudyDayId());
      localStorage.setItem(sk("pomodoroCompleted"), String(completedPomodori));
      localStorage.setItem(sk("pomodoroRemaining"), String(remainingSeconds));
      localStorage.setItem(sk("pomodoroIsRunning"), isRunning ? "true" : "false");
      if (isRunning) {
        localStorage.setItem(sk("pomodoroLastUpdate"), String(Date.now()));
      }
    }

    function loadPomodoroState() {
      const currentDay = getStudyDayId();
      const savedDay = localStorage.getItem(sk("pomodoroDayId"));
      if (savedDay !== currentDay) {
        completedPomodori = 0;
        remainingSeconds = POMODORO_DURATION;
        isRunning = false;
        savePomodoroState();
        return;
      }

      const savedCompleted = parseInt(localStorage.getItem(sk("pomodoroCompleted")) || "0", 10);
      const savedRemaining = parseInt(localStorage.getItem(sk("pomodoroRemaining")) || String(POMODORO_DURATION), 10);
      const savedIsRunning = localStorage.getItem(sk("pomodoroIsRunning")) === "true";
      const savedLastUpdate = parseInt(localStorage.getItem(sk("pomodoroLastUpdate")) || "0", 10);

      completedPomodori = isNaN(savedCompleted) ? 0 : savedCompleted;
      remainingSeconds = isNaN(savedRemaining) ? POMODORO_DURATION : savedRemaining;
      isRunning = savedIsRunning;

      if (isRunning && savedLastUpdate > 0) {
        const delta = Math.floor((Date.now() - savedLastUpdate) / 1000);
        remainingSeconds = Math.max(0, remainingSeconds - delta);
        if (remainingSeconds === 0) {
          isRunning = false;
        }
      }
    }

    function formatTime(seconds) {
      const m = Math.floor(seconds / 60);
      const s = seconds % 60;
      return `${String(m).padStart(2, "0")}:${String(s).padStart(2, "0")}`;
    }

    function updatePomodoroUI() {
      const timerEl = document.getElementById("pomodoro-timer");
      const startPauseBtn = document.getElementById("startPauseBtn");
      const countEl = document.getElementById("pomodoro-count");
      const dotsEl = document.getElementById("pomodoro-dots");
      if (!timerEl || !startPauseBtn || !countEl || !dotsEl) return;

      timerEl.textContent = formatTime(remainingSeconds);
      startPauseBtn.innerHTML = isRunning ? "⏸ Pausa" : "▶ Avvia";

      countEl.textContent = `${completedPomodori} / ${MAX_POMODORI} pomodori`;

      dotsEl.innerHTML = "";
      for (let i = 0; i < MAX_POMODORI; i++) {
        const dot = document.createElement("div");
        dot.className = "pomodoro-dot" + (i < completedPomodori ? " done" : "");
        dotsEl.appendChild(dot);
      }
    }

    function tick() {
      if (!isRunning) return;
      remainingSeconds -= 1;
      if (remainingSeconds <= 0) {
        remainingSeconds = 0;
        isRunning = false;
        completedPomodori = Math.min(MAX_POMODORI, completedPomodori + 1);
        savePomodoroState();
        updatePomodoroUI();
        return;
      }
      savePomodoroState();
      updatePomodoroUI();
    }

    function startTimer() {
      if (timerInterval) clearInterval(timerInterval);
      timerInterval = setInterval(tick, 1000);
    }

    function toggleStartPause() {
      if (completedPomodori >= MAX_POMODORI) {
        updatePomodoroUI();
        return;
      }
      isRunning = !isRunning;
      if (isRunning) {
        localStorage.setItem(sk("pomodoroLastUpdate"), String(Date.now()));
        startTimer();
      } else {
        if (timerInterval) clearInterval(timerInterval);
      }
      savePomodoroState();
      updatePomodoroUI();
    }

    function resetCurrentPomodoro() {
      isRunning = false;
      remainingSeconds = POMODORO_DURATION;
      if (timerInterval) clearInterval(timerInterval);
      savePomodoroState();
      updatePomodoroUI();
    }

    function resetStudyDay() {
      isRunning = false;
      completedPomodori = 0;
      remainingSeconds = POMODORO_DURATION;
      if (timerInterval) clearInterval(timerInterval);
      savePomodoroState();
      updatePomodoroUI();
    }

    function initPomodoro() {
      loadPomodoroState();
      updatePomodoroUI();
      if (isRunning) {
        startTimer();
      }
      document.getElementById("startPauseBtn").addEventListener("click", toggleStartPause);
      document.getElementById("resetPomodoroBtn").addEventListener("click", resetCurrentPomodoro);
      document.getElementById("resetDayBtn").addEventListener("click", resetStudyDay);
    }

    // --- ANTEPRIMA MATERIALE (supporta più sezioni) ---
    function initMaterialPreview(sectionId, previewId, infoId) {
      const section = document.getElementById(sectionId);
      const preview = document.getElementById(previewId);
      const info = document.getElementById(infoId);
      if (!section || !preview || !info) return;

      const cards = section.querySelectorAll(".resource-card");
      cards.forEach((card) => {
        card.addEventListener("click", (event) => {
          const openLink = event.target.closest(".resource-open");
          if (openLink) return;

          const url = card.dataset.url || "";
          const title = card.dataset.title || "File";
          const date = card.dataset.date || "N/D";
          const noPreview = card.dataset.noPreview === "true";

          if (noPreview) {
            preview.src = "";
            info.textContent = `${title} · anteprima non disponibile (apri con ↗)`;
            return;
          }

          preview.src = transformDriveUrl(url);
          info.textContent = `${title} · ${date}`;
        });
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      initVideoSection({
        videos: videosFondamenti,
        playerId: "videoPlayerFond",
        playlistId: "playlistFond",
        positionId: "videoPositionFond",
        prevBtnId: "prevVideoBtnFond",
        nextBtnId: "nextVideoBtnFond",
        markSeenBtnId: "markSeenBtnFond",
        storageKeySeen: "fondamenti_seenVideos"
      });

      initVideoSection({
        videos: videosMatlab,
        playerId: "videoPlayerMat",
        playlistId: "playlistMat",
        positionId: "videoPositionMat",
        prevBtnId: "prevVideoBtnMat",
        nextBtnId: "nextVideoBtnMat",
        markSeenBtnId: "markSeenBtnMat",
        storageKeySeen: "fondamenti_matlab_seenVideos"
      });

      initPomodoro();

      initMaterialPreview("materialFondSection", "materialPreviewFond", "materialInfoFond");
      initMaterialPreview("materialMatSection", "materialPreviewMat", "materialInfoMat");
    });

  </script>
</body>
</html>
